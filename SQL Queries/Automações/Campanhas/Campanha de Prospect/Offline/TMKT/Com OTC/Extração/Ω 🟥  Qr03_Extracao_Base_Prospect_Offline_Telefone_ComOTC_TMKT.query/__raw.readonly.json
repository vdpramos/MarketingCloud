{
  "queryDefinitionId": "c27549c2-af52-496f-8ed6-a989562230bc",
  "name": "Qr03_Extracao_Base_Prospect_Offline_Telefone_ComOTC_TMKT",
  "key": "78cea2fe-cf46-4898-a379-78460d0abab0",
  "description": "",
  "queryText": "SELECT \r\n  COD_PARCEIRO,\r\n  CPF,\r\n  CNPJ,\r\n  TIPO,\r\n  DDD,\r\n  TELEFONE\r\nFROM (\r\n\r\n  SELECT DISTINCT\r\n    'TCBB' AS COD_PARCEIRO,\r\n    A.CPF,\r\n    '' AS CNPJ,\r\n    CASE WHEN LEN(B.TEL_01) >= 9 THEN 'MÓVEL' ELSE 'FIXO' END AS TIPO,\r\n    B.DDD_01 AS DDD,\r\n    B.TEL_01 AS TELEFONE\r\n  FROM\r\n    TB_BASE_PROSPECT_OTC291_FILTRADA_TMKT A \r\n      INNER JOIN TB_BASE_PROSPECT_COMOTC_TRATADA_TMKT B ON A.CPF = RIGHT(REPLICATE ('0' , 15)+CONVERT(VARCHAR, B.CPF), 11)\r\n      INNER JOIN HC_Relacao_Cliente_Parceiro__c_Salesforce REL ON A.CPF = REL.CPF_CNPJ_Cliente__c\r\n      INNER JOIN Contact_Salesforce C on RIGHT(REPLICATE ('0' , 15)+CONVERT(VARCHAR, C.HC_CPF_CNPJ__c), 11) = B.CPF\r\n      INNER JOIN ACCOUNT_SALESFORCE D on C.AccountId = D.ID\r\n  WHERE\r\n       LEN(NULLIF(TEL_01, '')) < 10\r\n  AND NOT( LEN(TEL_01) = 8 AND TEL_01 LIKE '9%' )\r\n  \r\n  UNION ALL\r\n\r\n  SELECT DISTINCT\r\n    'TCBB' AS COD_PARCEIRO,\r\n    A.CPF,\r\n    '' AS CNPJ,\r\n    CASE WHEN LEN(B.TEL_02) >= 9 THEN 'MÓVEL' ELSE 'FIXO' END AS TIPO,\r\n    B.DDD_02 AS DDD,\r\n    B.TEL_02 AS TELEFONE\r\n  FROM\r\n    TB_BASE_PROSPECT_OTC291_FILTRADA_TMKT A \r\n      INNER JOIN TB_BASE_PROSPECT_COMOTC_TRATADA_TMKT B ON A.CPF = RIGHT(REPLICATE ('0' , 15)+CONVERT(VARCHAR, B.CPF), 11)\r\n      INNER JOIN HC_Relacao_Cliente_Parceiro__c_Salesforce REL ON A.CPF = REL.CPF_CNPJ_Cliente__c\r\n      INNER JOIN Contact_Salesforce C on RIGHT(REPLICATE ('0' , 15)+CONVERT(VARCHAR, C.HC_CPF_CNPJ__c), 11) = B.CPF\r\n      INNER JOIN ACCOUNT_SALESFORCE D on C.AccountId = D.ID\r\n  WHERE\r\n       LEN(NULLIF(TEL_02, '')) < 10\r\n  AND NOT( LEN(TEL_02) = 8 AND TEL_02 LIKE '9%' )\r\n  \r\n  UNION ALL\r\n\r\n  SELECT DISTINCT\r\n    'TCBB' AS COD_PARCEIRO,\r\n    A.CPF,\r\n    '' AS CNPJ,\r\n    CASE WHEN LEN(B.TEL_03) >= 9 THEN 'MÓVEL' ELSE 'FIXO' END AS TIPO,\r\n    B.DDD_03 AS DDD,\r\n    B.TEL_03 AS TELEFONE\r\n  FROM\r\n    TB_BASE_PROSPECT_OTC291_FILTRADA_TMKT A \r\n      INNER JOIN TB_BASE_PROSPECT_COMOTC_TRATADA_TMKT B ON A.CPF = RIGHT(REPLICATE ('0' , 15)+CONVERT(VARCHAR, B.CPF), 11)\r\n      INNER JOIN HC_Relacao_Cliente_Parceiro__c_Salesforce REL ON A.CPF = REL.CPF_CNPJ_Cliente__c\r\n      INNER JOIN Contact_Salesforce C on RIGHT(REPLICATE ('0' , 15)+CONVERT(VARCHAR, C.HC_CPF_CNPJ__c), 11) = B.CPF\r\n      INNER JOIN ACCOUNT_SALESFORCE D on C.AccountId = D.ID\r\n  WHERE\r\n       LEN(NULLIF(TEL_03, '')) < 10\r\n  AND NOT( LEN(TEL_03) = 8 AND TEL_03 LIKE '9%' )\r\n  \r\n  UNION ALL\r\n\r\n  SELECT DISTINCT\r\n    'TCBB' AS COD_PARCEIRO,\r\n    A.CPF,\r\n    '' AS CNPJ,\r\n    CASE WHEN LEN(B.TEL_04) >= 9 THEN 'MÓVEL' ELSE 'FIXO' END AS TIPO,\r\n    B.DDD_04 AS DDD,\r\n    B.TEL_04 AS TELEFONE\r\n  FROM\r\n    TB_BASE_PROSPECT_OTC291_FILTRADA_TMKT A \r\n      INNER JOIN TB_BASE_PROSPECT_COMOTC_TRATADA_TMKT B ON A.CPF = RIGHT(REPLICATE ('0' , 15)+CONVERT(VARCHAR, B.CPF), 11)\r\n      INNER JOIN HC_Relacao_Cliente_Parceiro__c_Salesforce REL ON A.CPF = REL.CPF_CNPJ_Cliente__c\r\n      INNER JOIN Contact_Salesforce C on RIGHT(REPLICATE ('0' , 15)+CONVERT(VARCHAR, C.HC_CPF_CNPJ__c), 11) = B.CPF\r\n      INNER JOIN ACCOUNT_SALESFORCE D on C.AccountId = D.ID\r\n  WHERE\r\n       LEN(NULLIF(TEL_04, '')) < 10\r\n  AND NOT( LEN(TEL_04) = 8 AND TEL_04 LIKE '9%' )\r\n  \r\n  UNION ALL\r\n\r\n  SELECT DISTINCT\r\n    'TCBB' AS COD_PARCEIRO,\r\n    A.CPF,\r\n    '' AS CNPJ,\r\n    CASE WHEN LEN(B.TEL_05) >= 9 THEN 'MÓVEL' ELSE 'FIXO' END AS TIPO,\r\n    B.DDD_05 AS DDD,\r\n    B.TEL_05 AS TELEFONE\r\n  FROM\r\n    TB_BASE_PROSPECT_OTC291_FILTRADA_TMKT A \r\n      INNER JOIN TB_BASE_PROSPECT_COMOTC_TRATADA_TMKT B ON A.CPF = RIGHT(REPLICATE ('0' , 15)+CONVERT(VARCHAR, B.CPF), 11)\r\n      INNER JOIN HC_Relacao_Cliente_Parceiro__c_Salesforce REL ON A.CPF = REL.CPF_CNPJ_Cliente__c\r\n      INNER JOIN Contact_Salesforce C on RIGHT(REPLICATE ('0' , 15)+CONVERT(VARCHAR, C.HC_CPF_CNPJ__c), 11) = B.CPF\r\n      INNER JOIN ACCOUNT_SALESFORCE D on C.AccountId = D.ID\r\n  WHERE\r\n      LEN(NULLIF(TEL_05, '')) < 10\r\n  AND NOT( LEN(TEL_05) = 8 AND TEL_05 LIKE '9%' )\r\n) A",
  "targetName": "Tb_Base_Prospect_Offline_Telefones_ComOTC_TMKT",
  "targetKey": "E9B53D1B-1F27-46BF-8B41-A7840887792A",
  "targetId": "f7d4bd72-9470-eb11-a2fc-48df37342c98",
  "targetDescription": "",
  "createdDate": "2021-02-17T06:44:36.607",
  "modifiedDate": "2022-07-01T06:46:20.59",
  "targetUpdateTypeId": 0,
  "targetUpdateTypeName": "Overwrite",
  "categoryId": 29381,
  "isFrozen": false
}