{
  "ssjsActivityId": "d29ecda0-e9f8-4906-abfb-e56eb9fc3fe3",
  "name": "Exclusao_contatos",
  "key": "69869eb7-4e45-4249-bd9d-0d70e0468cbd",
  "description": "",
  "script": "<script runat=\"server\">\n  Platform.Load(\"Core\", \"1\");\n  //CONFIG\n  var baseURL = 'https://mcn724g5q4ftdks0ym7-hmp2s691';\n  var client_id = 'ie69ep03ytzxu0mpai4bt869';\n  var client_secret = 'QNnWNjQJk9MQdrjxg0yWOltj';\n  var DE = 'B301ECBB-91C7-4390-91BA-69CC479CCEFA'; //DE NAME: Exclusao_contatos\n  var LogDE = DataExtension.Init(\"6EF0D027-ABDD-460C-8D31-51A13D6D7398\"); //DE NAME: Exclusao_contatos_Log\n  //AUTHENTICATE\n  try {\n      var url = baseURL+'.auth.marketingcloudapis.com/v2/token';\n      var contentType = 'application/json';\n      var payload = '{\"grant_type\": \"client_credentials\",\"client_id\": \"'+client_id+'\",\"client_secret\": \"'+client_secret+'\"}';\n      var accessTokenRequest = HTTP.Post(url, contentType, payload);\n      var accessToken = Platform.Function.ParseJSON(accessTokenRequest[\"Response\"][0]).access_token;\n      if(accessToken !='')\n        //EXECUTE\n      {\n        try { \n          var deleteUrl = baseURL+'.rest.marketingcloudapis.com/contacts/v1/contacts/actions/delete?type=listReference';\n          var payload1 = '{\"deleteOperationType\": \"ContactAndAttributes\",\"targetList\": {\"listType\": {\"listTypeID\": 3},\"listKey\": \"'+DE+'\"},\"deleteListWhenCompleted\": false,\"deleteListContentsWhenCompleted\": false}';\n          var headerNames = [\"Authorization\"];\n          var s1=\"Bearer \";\n          var headerValues = [s1.concat(accessToken)];\n          var request = HTTP.Post(deleteUrl, contentType, payload1, headerNames, headerValues);\n          var requestResponse = Platform.Function.ParseJSON(request[\"Response\"][0]);\n          LogDE.Rows.Add({Resultado:\"Success\",RowCount:requestResponse.targetListInformation.rowCount,OperationID:requestResponse.operationID});\n        }\n        catch (err) {\n          LogDE.Rows.Add({Resultado:\"Error: \" + Stringify(err)});\n        }\n      }\n    }\n  catch (e) {\n    LogDE.Rows.Add({Resultado:\"Error: \" + Stringify(e)});\n  }\n</script>",
  "categoryId": 58198,
  "createdDate": "2023-01-19T14:36:35.36",
  "modifiedDate": "2023-01-25T08:47:41.19"
}