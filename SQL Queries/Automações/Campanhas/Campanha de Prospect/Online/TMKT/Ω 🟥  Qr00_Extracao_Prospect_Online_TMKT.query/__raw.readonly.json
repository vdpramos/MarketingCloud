{
  "queryDefinitionId": "4989c9a7-570e-49ec-9ee4-aa2fbc2a591a",
  "name": "Qr00_Extracao_Prospect_Online_TMKT",
  "key": "57eeaa95-7b6c-4586-9931-749b9bbe04d5",
  "description": "Extração do resultado da campanha para discador",
  "queryText": "SELECT\n        CASE\n          WHEN NULLIF(TEL_01, '') IS NULL THEN NULL\n          WHEN LEN(Tel_01) > 9 OR ( LEN(Tel_01) = 8 AND Tel_01 LIKE '9%' ) THEN NULL\n          ELSE b.Ddd_01\n        END AS DDD1,\n        CASE\n          WHEN NULLIF(TEL_01, '') IS NULL THEN NULL\n          WHEN LEN(Tel_01) > 9 OR ( LEN(Tel_01) = 8 AND Tel_01 LIKE '9%' ) THEN NULL\n          ELSE Tel_01\n        END AS TELEFONE1,\n        CASE\n          WHEN NULLIF(TEL_01, '') IS NULL THEN NULL\n          WHEN LEN(Tel_01) > 9 OR ( LEN(Tel_01) = 8 AND Tel_01 LIKE '9%' ) THEN NULL\n          WHEN (len(B.TEL_01) = 9) THEN 'MÓVEL'\n          ELSE 'FIXO'\n        END AS TIPO1,\n        CASE\n          WHEN NULLIF(TEL_02, '') IS NULL THEN NULL\n          WHEN LEN(Tel_02) > 9 OR ( LEN(Tel_02) = 8 AND Tel_02 LIKE '9%' ) THEN NULL\n          ELSE b.Ddd_02\n        END AS DDD2,\n        CASE\n          WHEN NULLIF(TEL_02, '') IS NULL THEN NULL\n          WHEN LEN(Tel_02) > 9 OR ( LEN(Tel_02) = 8 AND Tel_02 LIKE '9%' ) THEN NULL\n          ELSE Tel_02\n        END AS TELEFONE2,\n        CASE\n          WHEN NULLIF(TEL_02, '') IS NULL THEN NULL\n          WHEN LEN(Tel_02) > 9 OR ( LEN(Tel_02) = 8 AND Tel_02 LIKE '9%' ) THEN NULL\n          WHEN (len(B.TEL_02) = 9) THEN 'MÓVEL'\n          ELSE 'FIXO'\n        END AS TIPO2,\n        CASE\n          WHEN NULLIF(TEL_03, '') IS NULL THEN NULL\n          WHEN LEN(Tel_03) > 9 OR ( LEN(Tel_03) = 8 AND Tel_03 LIKE '9%' ) THEN NULL\n          ELSE b.Ddd_03\n        END AS DDD3,\n        CASE\n          WHEN NULLIF(TEL_03, '') IS NULL THEN NULL\n          WHEN LEN(Tel_03) > 9 OR ( LEN(Tel_03) = 8 AND Tel_03 LIKE '9%' ) THEN NULL\n          ELSE Tel_03\n        END AS TELEFONE3,\n        CASE\n          WHEN NULLIF(TEL_03, '') IS NULL THEN NULL\n          WHEN LEN(Tel_03) > 9 OR ( LEN(Tel_03) = 8 AND Tel_03 LIKE '9%' ) THEN NULL\n          WHEN (len(B.TEL_03) = 9) THEN 'MÓVEL'\n          ELSE 'FIXO'\n        END AS TIPO3,\n        CASE\n          WHEN NULLIF(TEL_04, '') IS NULL THEN NULL\n          WHEN LEN(Tel_04) > 9 OR ( LEN(Tel_04) = 8 AND Tel_04 LIKE '9%' ) THEN NULL\n          ELSE b.Ddd_04\n        END AS DDD4,\n        CASE\n          WHEN NULLIF(TEL_04, '') IS NULL THEN NULL\n          WHEN LEN(Tel_04) > 9 OR ( LEN(Tel_04) = 8 AND Tel_04 LIKE '9%' ) THEN NULL\n          ELSE Tel_04\n        END AS TELEFONE4,\n        CASE\n          WHEN NULLIF(TEL_04, '') IS NULL THEN NULL\n          WHEN LEN(Tel_04) > 9 OR ( LEN(Tel_04) = 8 AND Tel_04 LIKE '9%' ) THEN NULL\n          WHEN (len(B.TEL_04) = 9) THEN 'MÓVEL'\n          ELSE 'FIXO'\n        END AS TIPO4,\n        CASE\n          WHEN NULLIF(TEL_05, '') IS NULL THEN NULL\n          WHEN LEN(Tel_05) > 9 OR ( LEN(Tel_05) = 8 AND Tel_05 LIKE '9%' ) THEN NULL\n          ELSE b.Ddd_05\n        END AS DDD5,\n        CASE\n          WHEN NULLIF(TEL_05, '') IS NULL THEN NULL\n          WHEN LEN(Tel_05) > 9 OR ( LEN(Tel_05) = 8 AND Tel_05 LIKE '9%' ) THEN NULL\n          ELSE Tel_05\n        END AS TELEFONE5,\n        CASE\n          WHEN NULLIF(TEL_05, '') IS NULL THEN NULL\n          WHEN LEN(Tel_05) > 9 OR ( LEN(Tel_05) = 8 AND Tel_05 LIKE '9%' ) THEN NULL\n          WHEN (len(B.TEL_05) = 9) THEN 'MÓVEL'\n          ELSE 'FIXO'\n        END AS TIPO5,        \n        CONVERT(VARCHAR(10), a.Dt_Nascimento, 103) AS DATA_NASCIMENTO,\n        B.Nome AS NOME_CLIENTE,\n        B.CEP,\n        a.UF_Residencial as UF,\n        a.Tipo_Pessoa AS TIPO_DE_PESSOA,\n        B.CPF as CPF_CNPJ,\n        B.Sexo,\n        B.Id_Campanha AS IDCAMPANHA,\n        c.id AS IDCONTATOS,\n        cp.id AS IDCP\nFROM\n    Tb_Base_Prospect_OTC291_Online_Filtrada_TMKT A\nINNER JOIN Tb_Base_Prospect_Online_Filtrada_TMKT B ON A.CPF = B.CPF\nINNER JOIN CONTACT_SALESFORCE C ON C.HC_CPF_CNPJ__C = A.CPF\nINNER JOIN HC_RELACAO_CLIENTE_PARCEIRO__C_SALESFORCE CP ON CP.HC_CPF_CNPJ__C = A.CPF  AND CP.HC_Chave_Parceiro__c = '52'\nINNER JOIN CampaignMember_SALESFORCE CM ON CM.CONTACTID = C.ID AND CM.CampaignId = '7016g000000NiyOAAS'\nWHERE \n (LEN(NULLIF(Tel_01, '')) < 10 AND NOT( LEN(Tel_01) = 8 AND Tel_01 LIKE '9%' ))\n OR (LEN(NULLIF(Tel_02, '')) < 10 AND NOT( LEN(Tel_02) = 8 AND Tel_02 LIKE '9%' ))\n OR (LEN(NULLIF(Tel_03, '')) < 10 AND NOT( LEN(Tel_03) = 8 AND Tel_03 LIKE '9%' ))\n OR (LEN(NULLIF(Tel_04, '')) < 10 AND NOT( LEN(Tel_04) = 8 AND Tel_04 LIKE '9%' ))\n OR (LEN(NULLIF(Tel_05, '')) < 10 AND NOT( LEN(Tel_05) = 8 AND Tel_05 LIKE '9%' ))\n AND C.ID IS NOT NULL AND CP.ID IS NOT NULL\n  ",
  "targetName": "Tb_Base_Prospect_Extracao_Online_TMKT",
  "targetKey": "2FF633F8-92C6-4D67-B597-D901E360FE45",
  "targetId": "a843bcfa-7c6d-ed11-a5b9-d4f5ef66af82",
  "targetDescription": "",
  "createdDate": "2022-11-26T05:55:45.953",
  "modifiedDate": "2022-11-30T17:50:44.95",
  "targetUpdateTypeId": 0,
  "targetUpdateTypeName": "Overwrite",
  "categoryId": 55868,
  "isFrozen": false
}