{
  "queryDefinitionId": "53ead13f-5bce-4142-bfc7-2c77557a9210",
  "name": "interactivequery-514002572-713428609",
  "key": "65953f45-c85e-4797-81d2-32e71f94841a",
  "description": "Query created by Query Studio",
  "queryText": "SELECT DISTINCT\n    rtrim(left(coalesce(CAST(B.HC_CPF_CNPJ__C as char(255)),'<null>'), 255)) as cpf_cnpj, rtrim(left(coalesce(CAST(C.NAME as char(255)),'<null>'), 255)) as nome, rtrim(left(coalesce(CAST(B.HC_IDADE__C as char(255)),'<null>'), 255)) as idade, rtrim(left(coalesce(CAST(B.HC_DATA_DE_NASCIMENTO__C as char(255)),'<null>'), 255)) as dt_nascimento, rtrim(left(coalesce(CAST(B.HC_GENERO_DO_CLIENTE__C as char(255)),'<null>'), 255)) as sexo, rtrim(left(coalesce(CAST(B.HC_PARCEIRO__C as char(255)),'<null>'), 255)) as parceiro, rtrim(left(coalesce(CAST(B.HC_TIPO_DE_PESSOA__C as char(255)),'<null>'), 255)) as tipo_pessoa, rtrim(left(coalesce(CAST(CASE WHEN B.HC_EMAIL_PRINCIPAL__C = 'Brasilcap' THEN HC_EMAIL_BRASILCAP__C\n\t\t\tWHEN B.HC_EMAIL_PRINCIPAL__C = 'Comercial' THEN HC_EMAIL_COMERCIAL__C\n\t\t\tWHEN B.HC_EMAIL_PRINCIPAL__C = 'Pessoal' THEN HC_EMAIL_PESSOAL__C\n\t\t\tWHEN B.HC_EMAIL_BRASILCAP__C IS NOT NULL THEN HC_EMAIL_BRASILCAP__C\n\t\t\tWHEN B.HC_EMAIL_COMERCIAL__C IS NOT NULL THEN HC_EMAIL_COMERCIAL__C\n\t\t\tWHEN B.HC_EMAIL_PESSOAL__C IS NOT NULL THEN HC_EMAIL_PESSOAL__C\n\t\t\tELSE NULL END as char(255)),'<null>'), 255)) as email, rtrim(left(coalesce(CAST(CASE WHEN B.HC_EMAIL_PRINCIPAL__C IN ('Brasilcap', 'Comercial', 'Pessoal') THEN 1\n\t\t\tWHEN B.HC_EMAIL_BRASILCAP__C IS NOT NULL THEN 1\n\t\t\tWHEN B.HC_EMAIL_COMERCIAL__C IS NOT NULL THEN 1\n\t\t\tWHEN B.HC_EMAIL_PESSOAL__C IS NOT NULL THEN 1\n\t\t\tELSE 0 END as char(255)),'<null>'), 255)) as email_valido, rtrim(left(coalesce(CAST(CASE WHEN B.HC_STATUS_CELULAR_1__C = 'VÁLIDO' THEN HC_CELULAR_1__C\n\t\t\tWHEN B.HC_STATUS_CELULAR_2__C = 'VÁLIDO' THEN HC_CELULAR_2__C\n\t\t\tWHEN B.HC_STATUS_CELULAR_3__C = 'VÁLIDO' THEN HC_CELULAR_3__C\n\t\t\tELSE NULL END as char(255)),'<null>'), 255)) as celular, rtrim(left(coalesce(CAST(CASE WHEN B.HC_STATUS_CELULAR_1__C = 'VÁLIDO' THEN 1\n\t\t\tWHEN B.HC_STATUS_CELULAR_2__C = 'VÁLIDO' THEN 1\n\t\t\tWHEN B.HC_STATUS_CELULAR_3__C = 'VÁLIDO' THEN 1\n\t\t\tELSE 0 END as char(255)),'<null>'), 255)) as celular_valido, rtrim(left(coalesce(CAST(LEFT(REPLACE(REPLACE(REPLACE(REPLACE(B.HC_TELEFONE_RESIDENCIAL__C, '(', ''), ')', ''), ' ', ''), '-', ''), 2) as char(255)),'<null>'), 255)) as ddd_tel_01, rtrim(left(coalesce(CAST(SUBSTRING(REPLACE(REPLACE(REPLACE(REPLACE(B.HC_TELEFONE_RESIDENCIAL__C, '(', ''), ')', ''), ' ', ''), '-', ''), 3, 9) as char(255)),'<null>'), 255)) as tel_01, rtrim(left(coalesce(CAST('FIXO' as char(255)),'<null>'), 255)) as tipo_tel_01, rtrim(left(coalesce(CAST(LEFT(REPLACE(REPLACE(REPLACE(REPLACE(B.HC_TELEFONE_COMERCIAL__C, '(', ''), ')', ''), ' ', ''), '-', ''), 2) as char(255)),'<null>'), 255)) as ddd_tel_02, rtrim(left(coalesce(CAST(SUBSTRING(REPLACE(REPLACE(REPLACE(REPLACE(B.HC_TELEFONE_COMERCIAL__C, '(', ''), ')', ''), ' ', ''), '-', ''), 3, 9) as char(255)),'<null>'), 255)) as tel_02, rtrim(left(coalesce(CAST('FIXO' as char(255)),'<null>'), 255)) as tipo_tel_02, rtrim(left(coalesce(CAST(LEFT(REPLACE(REPLACE(REPLACE(REPLACE(B.HC_TELEFONE_OUTRO__C, '(', ''), ')', ''), ' ', ''), '-', ''), 2) as char(255)),'<null>'), 255)) as ddd_tel_03, rtrim(left(coalesce(CAST(SUBSTRING(REPLACE(REPLACE(REPLACE(REPLACE(B.HC_TELEFONE_OUTRO__C, '(', ''), ')', ''), ' ', ''), '-', ''), 3, 9) as char(255)),'<null>'), 255)) as tel_03, rtrim(left(coalesce(CAST('FIXO' as char(255)),'<null>'), 255)) as tipo_tel_03, rtrim(left(coalesce(CAST(LEFT(REPLACE(REPLACE(REPLACE(REPLACE(B.HC_CELULAR_1__C, '(', ''), ')', ''), ' ', ''), '-', ''), 2) as char(255)),'<null>'), 255)) as ddd_tel_04, rtrim(left(coalesce(CAST(SUBSTRING(REPLACE(REPLACE(REPLACE(REPLACE(B.HC_CELULAR_1__C, '(', ''), ')', ''), ' ', ''), '-', ''), 3, 9) as char(255)),'<null>'), 255)) as tel_04, rtrim(left(coalesce(CAST('MÓVEL' as char(255)),'<null>'), 255)) as tipo_tel_04, rtrim(left(coalesce(CAST(LEFT(REPLACE(REPLACE(REPLACE(REPLACE(B.HC_CELULAR_2__C, '(', ''), ')', ''), ' ', ''), '-', ''), 2) as char(255)),'<null>'), 255)) as ddd_tel_05, rtrim(left(coalesce(CAST(SUBSTRING(REPLACE(REPLACE(REPLACE(REPLACE(B.HC_CELULAR_2__C, '(', ''), ')', ''), ' ', ''), '-', ''), 3, 9) as char(255)),'<null>'), 255)) as tel_05, rtrim(left(coalesce(CAST('MÓVEL' as char(255)),'<null>'), 255)) as tipo_tel_05, rtrim(left(coalesce(CAST(LEFT(REPLACE(REPLACE(REPLACE(REPLACE(B.HC_CELULAR_3__C, '(', ''), ')', ''), ' ', ''), '-', ''), 2) as char(255)),'<null>'), 255)) as ddd_tel_06, rtrim(left(coalesce(CAST(SUBSTRING(REPLACE(REPLACE(REPLACE(REPLACE(B.HC_CELULAR_3__C, '(', ''), ')', ''), ' ', ''), '-', ''), 3, 9) as char(255)),'<null>'), 255)) as tel_06, rtrim(left(coalesce(CAST('MÓVEL' as char(255)),'<null>'), 255)) as tipo_tel_06, rtrim(left(coalesce(CAST(B.HC_TELEFONE_PRINCIPAL__C as char(255)),'<null>'), 255)) as tel_principal, rtrim(left(coalesce(CAST(B.HC_CLASSIFICACAO__C as char(255)),'<null>'), 255)) as publico_alvo, rtrim(left(coalesce(CAST(A.[TYPE] as char(255)),'<null>'), 255)) as tipo_campanha, rtrim(left(coalesce(CAST(A.STARTDATE as char(255)),'<null>'), 255)) as dt_inicio_mailing, rtrim(left(coalesce(CAST(A.ENDDATE as char(255)),'<null>'), 255)) as dt_fim_mailing, rtrim(left(coalesce(CAST(A.HC_VALIDA_ALTA_RENDA__C as char(255)),'<null>'), 255)) as campanha_valida_encarteiramento, rtrim(left(coalesce(CAST(A.HC_VALIDA_NAO_IMPORTUNE__C as char(255)),'<null>'), 255)) as campanha_nao_importune, rtrim(left(coalesce(CAST(A.HC_VALIDA_RNA__C as char(255)),'<null>'), 255)) as campanha_valida_rna, rtrim(left(coalesce(CAST(A.HC_PRODUTO__C as char(255)),'<null>'), 255)) as id_produto, rtrim(left(coalesce(CAST(A.HC_PRECO_DO_PRODUTO__C as char(255)),'<null>'), 255)) as id_produto_valor, rtrim(left(coalesce(CAST(B.HC_CPF_CNPJ__C as char(255)),'<null>'), 255)) as id, rtrim(left(coalesce(CAST(A.ID as char(255)),'<null>'), 255)) as id_campanha, rtrim(left(coalesce(CAST(B.ID as char(255)),'<null>'), 255)) as id_cliente_parceiro, rtrim(left(coalesce(CAST(B.HC_CLIENTE__C as char(255)),'<null>'), 255)) as id_cliente, rtrim(left(coalesce(CAST(B.HC_CPF_CNPJ_CODIGO_DO_PARCEIRO__C as char(255)),'<null>'), 255)) as cpf_cnpj_codigo_do_parceiro, rtrim(left(coalesce(CAST(D.HC_Data_Inicio_Sorteio__c as char(255)),'<null>'), 255)) as dt_inicio_sorteio, rtrim(left(coalesce(CAST(A.HC_Valor_maximo_de_contemplacao__c as char(255)),'<null>'), 255)) as valor_max_contemplacao, rtrim(left(coalesce(CAST(A.HC_Valor_minimo_de_contemplacao__c as char(255)),'<null>'), 255)) as valor_min_contemplacao, rtrim(left(coalesce(CAST(A.HC_Data_inicial_de_contemplacao__c as char(255)),'<null>'), 255)) as dt_inicio_contemplacao, rtrim(left(coalesce(CAST(A.HC_Data_fim_de_contemplacao__c as char(255)),'<null>'), 255)) as dt_fim_contemplacao, rtrim(left(coalesce(CAST(CONVERT(CHAR(10), D.HC_Data_da_Ultima_Contemplacao__c, 104) as char(255)),'<null>'), 255)) as dt_ultima_contemplacao, rtrim(left(coalesce(CAST(D.HC_Numero_da_Sorte__c as char(255)),'<null>'), 255)) as numero_sorteado, rtrim(left(coalesce(CAST(D.HC_Valor_Premio__c as char(255)),'<null>'), 255)) as valor_premio, rtrim(left(coalesce(CAST(CASE WHEN DATEPART(WEEKDAY, GetDate()) = 6 THEN DATEADD(DAY, 3, DATEADD(HH, 3, A.HC_DATA_DE_EXECUCAO__C)) ELSE DATEADD(DAY, A.HC_PROXIMA_EXECUCAO__C, DATEADD(HH, 3, A.HC_DATA_DE_EXECUCAO__C)) END as char(255)),'<null>'), 255)) as data_proxima_execucao from CAMPAIGN_SALESFORCE A\nINNER JOIN HC_RELACAO_CLIENTE_PARCEIRO__C_SALESFORCE B ON A.HC_PARCEIRO__C = B.HC_PARCEIRO__C\nINNER JOIN HC_TITULO__C_SALESFORCE D ON D.HC_CLIENTE_X_PARCEIRO__C = B.ID\nINNER JOIN CONTACT_SALESFORCE C ON C.HC_CPF_CNPJ__C = B.HC_CPF_CNPJ__C\nWHERE\n    UPPER(A.[TYPE]) = 'AUTOMÁTICO'\n/*AND A.ID = '7016g000000NVYrAAO'*/\nAND D.HC_Data_da_Ultima_Contemplacao__c BETWEEN A.HC_Data_inicial_de_contemplacao__c AND A.HC_Data_fim_de_contemplacao__c\n\n",
  "targetName": "QueryStudioResults at 2021-12-11T0209460000",
  "targetKey": "QueryStudioResults at 2021-12-11T0209460000",
  "targetId": "52548a63-275a-ec11-a311-48df370eabe5",
  "targetDescription": "Auto generated by Query Studio. Auto deletes after 24 hours.",
  "createdDate": "2021-04-07T15:18:15.447",
  "modifiedDate": "2021-12-10T20:09:48.78",
  "targetUpdateTypeId": 0,
  "targetUpdateTypeName": "Overwrite",
  "categoryId": 1930,
  "isFrozen": false
}