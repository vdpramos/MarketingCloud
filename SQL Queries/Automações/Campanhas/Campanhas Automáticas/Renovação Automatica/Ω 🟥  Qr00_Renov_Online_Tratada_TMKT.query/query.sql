SELECT DISTINCT
    UPPER(A.NOME) AS NOME,
	RIGHT(REPLICATE ('0' , 15)+CONVERT(VARCHAR, A.CPF), 11) AS CPF,
	A.AGENCIA,
	A.CONTA,
	A.TIPO_CONTA,
	A.DATA_NASCIMENTO,
	A.SEXO,
	A.CEP,
	A.DDD_01,
	A.TEL_01,
	A.DDD_02,
	A.TEL_02,
	A.DDD_03,
	A.TEL_03,
	A.DDD_04,
	A.TEL_04,
	A.DDD_05,
	A.TEL_05,
	CL.HC_Banco_1__c as Banco,
	CL.HC_Digito_da_Agencia_1__c as Digito_Verificador_Agencia,
	CL.HC_Digito_da_Conta_1__c AS Digito_Verificador_Conta,
	CL.HC_Terceiro_Digito_Conta_Corrente_1__c as Agencia_Conta_Digito_Verificador,
  CA.ID AS ID_CAMPANHA,
  CA.HC_PRODUTO__C AS NOME_PRODUTO,
  CA.HC_PRECO_DO_PRODUTO__C AS NOME_PRODUTO_VALOR,
  CA.HC_VALIDA_ALTA_RENDA__C AS VALIDA_ENCARTEIRAMENTO,
  CA.HC_VALIDA_NAO_IMPORTUNE__C AS VALIDA_NAO_IMPORTUNE,
  CA.HC_VALIDA_RNA__C AS VALIDA_RNA,
  CL.ID as ID_CLIENTE_PARCEIRO,
  CASE WHEN DATEDIFF(YY, CAST(A.DATA_NASCIMENTO AS DATE), GETDATE()) BETWEEN 18 AND 70 THEN 1 ELSE 0 END AS IDADE_VALIDA,
  CASE WHEN (UPPER(A.TIPO_CONTA) = 'CC' OR UPPER(A.TIPO_CONTA) = 'CONTA CORRENTE') THEN 1 ELSE 0 END AS CONTA_CORRENTE,
  CASE WHEN Q.CPF_CNPJ IS NOT NULL AND Q.DATA_PARTICIPACAO_CAMPANHA > DATEADD(DD, -90, GETDATE()) THEN 1 ELSE 0 END AS QUARENTENA, 
  CASE WHEN CL.HC_CPF_CNPJ__C IS NOT NULL AND PAR.NAME = 'BB CORRETORA - 52' THEN 1 ELSE 0 END AS CLIENTE,
  CASE WHEN CL.HC_CPF_CNPJ__C IS NOT NULL AND CL.HC_CONSELHEIRO__C = 1 THEN 1 ELSE 0 END AS CONSELHEIRO,
CASE WHEN ISNULL(A.CEP, '') = '' OR A.CEP = ' ' THEN 0 ELSE 1 END AS CEP_VALIDO
FROM Renovacao_Online_TMKT A
INNER JOIN CAMPAIGN_SALESFORCE CA ON CA.Id = '7016g000000B5LZAA0'
LEFT JOIN HC_RELACAO_CLIENTE_PARCEIRO__C_SALESFORCE CL ON RIGHT(REPLICATE ('0' , 15)+CONVERT(VARCHAR, A.CPF), 11) = RIGHT(REPLICATE ('0' , 15)+CONVERT(VARCHAR, CL.HC_CPF_CNPJ__C), 11)
LEFT JOIN HC_PARCEIRO__C_SALESFORCE PAR ON PAR.ID = CL.HC_PARCEIRO__C
LEFT JOIN TB_BASE_QUARENTENA Q ON RIGHT(REPLICATE ('0' , 15)+CONVERT(VARCHAR, A.CPF), 11) = RIGHT(REPLICATE ('0' , 15)+CONVERT(VARCHAR, Q.CPF_CNPJ), 11)
