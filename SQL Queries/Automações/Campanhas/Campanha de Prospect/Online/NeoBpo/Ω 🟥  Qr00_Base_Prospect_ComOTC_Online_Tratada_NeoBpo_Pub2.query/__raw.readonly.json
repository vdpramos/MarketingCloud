{
  "queryDefinitionId": "525db83a-5477-4b6f-b1e7-2db36c6eca8f",
  "name": "Qr00_Base_Prospect_ComOTC_Online_Tratada_NeoBpo_Pub2",
  "key": "28b3a39d-2f9d-403e-8081-d3bf965afab7",
  "description": "",
  "queryText": "SELECT DISTINCT\n    UPPER (replace(replace(replace( replace( replace( replace( replace( replace( replace (replace (replace (replace (replace (replace (replace (replace (replace (replace (replace (replace (replace (replace (replace (replace (replace (replace (replace (replace (replace (replace (replace (replace (NOME, 'á', 'a'),'é', 'e'),'í', 'i'),'ó', 'o'),'ú', 'u'),'Á', 'A'),'É', 'E'),'Í', 'I'),'Ó', 'O'),'Ú', 'U'),'à', 'a'),'À', 'A'),'ã', 'a'),'õ', 'o'),'Ã', 'A'),  'Õ', 'O'),'â', 'a'),'ê', 'e'),'ô', 'o'),'Â', 'A'),'Ê', 'E'),'Ô', 'O'),'ç', 'c'),'Ç', 'c') , '-', '') , '+', '') , '|', '') , '$', '') , '%', '') , '&', '') , '¦', ''),'''', ' ')) as NOME,\n\tRIGHT(REPLICATE ('0' , 15)+CONVERT(VARCHAR, A.CPF), 11) AS CPF,\n\tA.AGENCIA,\n\tA.CONTA,\n\tA.TIPO_CONTA,\n\tA.DATA_NASCIMENTO,\n\tA.SEXO,\n\tA.CEP,\n\tA.DDD_01,\n\tA.TEL_01,\n\tA.DDD_02,\n\tA.TEL_02,\n\tA.DDD_03,\n\tA.TEL_03,\n\tA.DDD_04,\n\tA.TEL_04,\n\tA.DDD_05,\n\tA.TEL_05,\n\tA.Dia_Prov,\n\tCL.HC_Banco_1__c as Banco,\n\tCL.HC_Digito_da_Agencia_1__c as Digito_Verificador_Agencia,\n\tCL.HC_Digito_da_Conta_1__c AS Digito_Verificador_Conta,\n\tCL.HC_Terceiro_Digito_Conta_Corrente_1__c as Agencia_Conta_Digito_Verificador,\n  CA.ID AS ID_CAMPANHA,\n  CA.HC_PRODUTO__C AS NOME_PRODUTO,\n  CA.HC_PRECO_DO_PRODUTO__C AS NOME_PRODUTO_VALOR,\n  CA.HC_VALIDA_ALTA_RENDA__C AS VALIDA_ENCARTEIRAMENTO,\n  CA.HC_VALIDA_NAO_IMPORTUNE__C AS VALIDA_NAO_IMPORTUNE,\n  CA.HC_VALIDA_RNA__C AS VALIDA_RNA,\n  CL.ID as ID_CLIENTE_PARCEIRO,\n  CASE WHEN DATEDIFF(YY, CAST(A.DATA_NASCIMENTO AS DATE), GETDATE()) BETWEEN 18 AND 70 THEN 1 ELSE 0 END AS IDADE_VALIDA,\n  CASE WHEN (UPPER(A.TIPO_CONTA) = 'CC' OR UPPER(A.TIPO_CONTA) = 'CONTA CORRENTE') THEN 1 ELSE 0 END AS CONTA_CORRENTE,\n  CASE WHEN Q.CPF_CNPJ IS NOT NULL AND Q.DATA_PARTICIPACAO_CAMPANHA > DATEADD(DD, -90, GETDATE()) THEN 1 ELSE 0 END AS QUARENTENA, \n  CASE WHEN CL.HC_CPF_CNPJ__C IS NOT NULL AND PAR.NAME = 'BB CORRETORA - 52' THEN 1 ELSE 0 END AS CLIENTE,\n  CASE WHEN CL.HC_CPF_CNPJ__C IS NOT NULL AND CL.HC_CONSELHEIRO__C = 1 THEN 1 ELSE 0 END AS CONSELHEIRO,\nCASE WHEN ISNULL(A.CEP, '') = '' OR A.CEP = ' ' THEN 0 ELSE 1 END AS CEP_VALIDO\nFROM TB_BASE_PROSPECT_COMOTC_ONLINE_NEOBPO_PUB2 A\nINNER JOIN CAMPAIGN_SALESFORCE CA ON A.FORNECEDOR = CA.HC_FORNECEDOR__c\nLEFT JOIN HC_RELACAO_CLIENTE_PARCEIRO__C_SALESFORCE CL ON RIGHT(REPLICATE ('0' , 15)+CONVERT(VARCHAR, A.CPF), 11) = CL.HC_CPF_CNPJ__C\nLEFT JOIN HC_PARCEIRO__C_SALESFORCE PAR ON PAR.ID = CL.HC_PARCEIRO__C\nLEFT JOIN TB_BASE_QUARENTENA Q ON RIGHT(REPLICATE ('0' , 15)+CONVERT(VARCHAR, A.CPF), 11) = Q.CPF_CNPJ\nWHERE\n    CA.HC_FORNECEDOR__C = 'NeoBpo'\n/*AND CONVERT(VARCHAR, CA.HC_Data_de_Execucao__c, 112) = CONVERT(VARCHAR, GETDATE(), 112)*/\nAND CA.[TYPE] = 'Prospect'\n/*AND CA.HC_VALIDA_RNA__C = 1*/\nAND CA.IsActive = 1\nAND CA.Id = '7016g00000072rkAAA'\nAND (\n\t/* Possui ao menos 1 telefone válido */\n\t(LEN(NULLIF(TEL_01, '')) < 10 AND NOT( LEN(TEL_01) = 8 AND TEL_01 LIKE '9%' ))\n\tOR (LEN(NULLIF(TEL_02, '')) < 10 AND NOT( LEN(TEL_02) = 8 AND TEL_02 LIKE '9%' ))\n\tOR (LEN(NULLIF(TEL_03, '')) < 10 AND NOT( LEN(TEL_03) = 8 AND TEL_03 LIKE '9%' ))\n\tOR (LEN(NULLIF(TEL_04, '')) < 10 AND NOT( LEN(TEL_04) = 8 AND TEL_04 LIKE '9%' ))\n\tOR (LEN(NULLIF(TEL_05, '')) < 10 AND NOT( LEN(TEL_05) = 8 AND TEL_05 LIKE '9%' ))\n)",
  "targetName": "Tb_Base_Prospect_ComOTC_Online_Tratada_NeoBpo_Pub2",
  "targetKey": "F22D822F-1350-4894-A74C-5DE94B5FB36A",
  "targetId": "81ba6eba-db40-ec11-a313-48df37342c99",
  "targetDescription": "",
  "createdDate": "2021-11-08T15:49:03.42",
  "modifiedDate": "2023-05-31T11:17:08.843",
  "targetUpdateTypeId": 0,
  "targetUpdateTypeName": "Overwrite",
  "categoryId": 40743,
  "isFrozen": false
}