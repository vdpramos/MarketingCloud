{
  "queryDefinitionId": "860eeedc-ce2a-4dd6-a963-c02a692d0f91",
  "name": "Qr00_Base_Prospect_Online_Tratada_TMKT",
  "key": "b2ac8b06-52bd-47e6-aaf6-fb7dc056a19c",
  "description": "",
  "queryText": "SELECT DISTINCT\n    UPPER(A.NOME) AS NOME,\n\tRIGHT(REPLICATE ('0' , 15)+CONVERT(VARCHAR, A.CPF), 11) AS CPF,\n\tA.AGENCIA,\n\tA.CONTA,\n\tA.TIPO_CONTA,\n\tA.DATA_NASCIMENTO,\n\tA.SEXO,\n\tA.CEP,\n\tA.DDD_01,\n\tA.TEL_01,\n\tA.DDD_02,\n\tA.TEL_02,\n\tA.DDD_03,\n\tA.TEL_03,\n\tA.DDD_04,\n\tA.TEL_04,\n\tA.DDD_05,\n\tA.TEL_05,\n\tCL.HC_Banco_1__c as Banco,\n\tCL.HC_Digito_da_Agencia_1__c as Digito_Verificador_Agencia,\n\tCL.HC_Digito_da_Conta_1__c AS Digito_Verificador_Conta,\n\tCL.HC_Terceiro_Digito_Conta_Corrente_1__c as Agencia_Conta_Digito_Verificador,\n  CA.ID AS ID_CAMPANHA,\n  CA.HC_PRODUTO__C AS NOME_PRODUTO,\n  CA.HC_PRECO_DO_PRODUTO__C AS NOME_PRODUTO_VALOR,\n  CA.HC_VALIDA_ALTA_RENDA__C AS VALIDA_ENCARTEIRAMENTO,\n  CA.HC_VALIDA_NAO_IMPORTUNE__C AS VALIDA_NAO_IMPORTUNE,\n  CA.HC_VALIDA_RNA__C AS VALIDA_RNA,\n  CL.ID as ID_CLIENTE_PARCEIRO,\n  CASE WHEN DATEDIFF(YY, CAST(A.DATA_NASCIMENTO AS DATE), GETDATE()) BETWEEN 18 AND 70 THEN 1 ELSE 0 END AS IDADE_VALIDA,\n  CASE WHEN (UPPER(A.TIPO_CONTA) = 'CC' OR UPPER(A.TIPO_CONTA) = 'CONTA CORRENTE') THEN 1 ELSE 0 END AS CONTA_CORRENTE,\n  CASE WHEN Q.CPF_CNPJ IS NOT NULL AND Q.DATA_PARTICIPACAO_CAMPANHA > DATEADD(DD, -90, GETDATE()) THEN 1 ELSE 0 END AS QUARENTENA, \n  CASE WHEN CL.HC_CPF_CNPJ__C IS NOT NULL AND PAR.NAME = 'BB CORRETORA - 52' THEN 1 ELSE 0 END AS CLIENTE,\n  CASE WHEN CL.HC_CPF_CNPJ__C IS NOT NULL AND CL.HC_CONSELHEIRO__C = 1 THEN 1 ELSE 0 END AS CONSELHEIRO,\nCASE WHEN ISNULL(A.CEP, '') = '' OR A.CEP = ' ' THEN 0 ELSE 1 END AS CEP_VALIDO\nFROM TB_BASE_PROSPECT_ONLINE_TMKT A\nINNER JOIN CAMPAIGN_SALESFORCE CA ON CA.Id = '7016g000000NiyOAAS'\nLEFT JOIN HC_RELACAO_CLIENTE_PARCEIRO__C_SALESFORCE CL ON RIGHT(REPLICATE ('0' , 15)+CONVERT(VARCHAR, A.CPF), 11) = RIGHT(REPLICATE ('0' , 15)+CONVERT(VARCHAR, CL.HC_CPF_CNPJ__C), 11)\nLEFT JOIN HC_PARCEIRO__C_SALESFORCE PAR ON PAR.ID = CL.HC_PARCEIRO__C\nLEFT JOIN TB_BASE_QUARENTENA Q ON RIGHT(REPLICATE ('0' , 15)+CONVERT(VARCHAR, A.CPF), 11) = RIGHT(REPLICATE ('0' , 15)+CONVERT(VARCHAR, Q.CPF_CNPJ), 11)\nWHERE\n    CA.IsActive = 1\n   /* AND (\n    \t Possui ao menos 1 telefone v√°lido \n    \t(LEN(NULLIF(TEL_01, '')) < 10 AND NOT( LEN(TEL_01) = 8 AND TEL_01 LIKE '9%' ))\n    \tOR (LEN(NULLIF(TEL_02, '')) < 10 AND NOT( LEN(TEL_02) = 8 AND TEL_02 LIKE '9%' ))\n    \tOR (LEN(NULLIF(TEL_03, '')) < 10 AND NOT( LEN(TEL_03) = 8 AND TEL_03 LIKE '9%' ))\n    \tOR (LEN(NULLIF(TEL_04, '')) < 10 AND NOT( LEN(TEL_04) = 8 AND TEL_04 LIKE '9%' ))\n    \tOR (LEN(NULLIF(TEL_05, '')) < 10 AND NOT( LEN(TEL_05) = 8 AND TEL_05 LIKE '9%' ))\n    )*/\n    /* verifica se possui sobrenome */\n          AND CHARINDEX(' ', A.NOME) > 0",
  "targetName": "Tb_Base_Prospect_Online_Tratada_TMKT",
  "targetKey": "E55C5F86-F4DF-4152-8F3C-869ED7B3FC38",
  "targetId": "8f6f76b7-2f6b-ed11-a5b9-d4f5ef66af82",
  "targetDescription": "",
  "createdDate": "2022-11-23T06:21:49.987",
  "modifiedDate": "2023-01-24T13:50:44.543",
  "targetUpdateTypeId": 0,
  "targetUpdateTypeName": "Overwrite",
  "categoryId": 55868,
  "isFrozen": false
}