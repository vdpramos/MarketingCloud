{
  "queryDefinitionId": "ae2b2388-c8fc-40f7-a376-0016bc4f0fbf",
  "name": "interactivequery-514002572-713917771",
  "key": "8343a61c-e6ec-49fb-9e2a-ea661a435289",
  "description": "Query created by Query Studio",
  "queryText": "SELECT  \n  rtrim(left(coalesce(CAST(B.HC_CPF_CNPJ__C as char(255)),'<null>'), 255)) as cpf_cnpj, rtrim(left(coalesce(CAST(C.NAME as char(255)),'<null>'), 255)) as nome, rtrim(left(coalesce(CAST(CASE WHEN B.HC_EMAIL_PRINCIPAL__C = 'Brasilcap' THEN HC_EMAIL_BRASILCAP__C\n    WHEN B.HC_EMAIL_PRINCIPAL__C = 'Comercial' THEN HC_EMAIL_COMERCIAL__C\n    WHEN B.HC_EMAIL_PRINCIPAL__C = 'Pessoal' THEN HC_EMAIL_PESSOAL__C\n    WHEN B.HC_EMAIL_BRASILCAP__C IS NOT NULL THEN HC_EMAIL_BRASILCAP__C\n    WHEN B.HC_EMAIL_COMERCIAL__C IS NOT NULL THEN HC_EMAIL_COMERCIAL__C\n    WHEN B.HC_EMAIL_PESSOAL__C IS NOT NULL THEN HC_EMAIL_PESSOAL__C\n    ELSE NULL END as char(255)),'<null>'), 255)) as email, rtrim(left(coalesce(CAST(CASE WHEN B.HC_EMAIL_PRINCIPAL__C IN ('Brasilcap', 'Comercial', 'Pessoal') THEN 1\n    WHEN B.HC_EMAIL_BRASILCAP__C IS NOT NULL THEN 1\n    WHEN B.HC_EMAIL_COMERCIAL__C IS NOT NULL THEN 1\n    WHEN B.HC_EMAIL_PESSOAL__C IS NOT NULL THEN 1\n    ELSE 0 END as char(255)),'<null>'), 255)) as email_valido, rtrim(left(coalesce(CAST(CASE WHEN B.HC_TELEFONE_PRINCIPAL__C = 'CELULAR 1' THEN HC_CELULAR_1__C\n    WHEN B.HC_TELEFONE_PRINCIPAL__C = 'CELULAR 2' THEN HC_CELULAR_2__C\n    WHEN B.HC_TELEFONE_PRINCIPAL__C = 'CELULAR 3' THEN HC_CELULAR_3__C\n    WHEN B.HC_TELEFONE_PRINCIPAL__C = 'CELULAR 3_3' THEN HC_CELULAR_3_3__C\n    WHEN B.HC_TELEFONE_PRINCIPAL__C = 'CELULAR 4' THEN HC_CELULAR_4__C\n    WHEN B.HC_STATUS_CELULAR_1__C = 'VÁLIDO' THEN HC_CELULAR_1__C\n    WHEN B.HC_STATUS_CELULAR_2__C = 'VÁLIDO' THEN HC_CELULAR_2__C\n    WHEN B.HC_STATUS_CELULAR_3__C = 'VÁLIDO' THEN HC_CELULAR_3__C\n    WHEN B.HC_STATUS_CELULAR_3_3__C = 'VÁLIDO' THEN HC_CELULAR_3_3__C\n    WHEN B.HC_STATUS_CELULAR_4__C = 'VÁLIDO' THEN HC_CELULAR_4__C\n    ELSE NULL END as char(255)),'<null>'), 255)) as celular, rtrim(left(coalesce(CAST(CASE WHEN B.HC_STATUS_CELULAR_1__C = 'VÁLIDO' THEN 1\n    WHEN B.HC_STATUS_CELULAR_2__C = 'VÁLIDO' THEN 1\n    WHEN B.HC_STATUS_CELULAR_3__C = 'VÁLIDO' THEN 1\n    WHEN B.HC_STATUS_CELULAR_3_3__C = 'VÁLIDO' THEN 1\n    WHEN B.HC_STATUS_CELULAR_4__C = 'VÁLIDO' THEN 1\n    ELSE 0 END as char(255)),'<null>'), 255)) as celular_valido, rtrim(left(coalesce(CAST(B.HC_NAO_DESEJA_RECEBER_SMS__C as char(255)),'<null>'), 255)) as nao_deseja_receber_sms, rtrim(left(coalesce(CAST(B.HC_NAO_DESEJA_RECEBER_EMAIL__C as char(255)),'<null>'), 255)) as nao_deseja_receber_email, rtrim(left(coalesce(CAST(A.ID as char(255)),'<null>'), 255)) as id_campanha, rtrim(left(coalesce(CAST(B.ID as char(255)),'<null>'), 255)) as id_cliente_parceiro, rtrim(left(coalesce(CAST(C.ID as char(255)),'<null>'), 255)) as id_contato, rtrim(left(coalesce(CAST(PROP.ID as char(255)),'<null>'), 255)) as id_proposta, rtrim(left(coalesce(CAST(PROP.CREATEDDATE as char(255)),'<null>'), 255)) as CREATEDDATE from CAMPAIGN_SALESFORCE A\nINNER JOIN HC_RELACAO_CLIENTE_PARCEIRO__C_SALESFORCE B ON A.HC_PARCEIRO__C = B.HC_PARCEIRO__C\nINNER JOIN CONTACT_SALESFORCE C ON C.HC_CPF_CNPJ__C = B.HC_CPF_CNPJ__C\nINNER JOIN HC_PROPOSTA__C_SALESFORCE PROP ON B.ID = PROP.HC_TITULAR__C\nLEFT JOIN AeM_Boas_Vindas_Historico_Propostas HIST ON HIST.ID_PROPOSTA = PROP.ID\nWHERE\n  (B.HC_TIPO_DE_PESSOA__C = A.HC_TIPO_DE_CLIENTE__C OR A.HC_TIPO_DE_CLIENTE__C = 'PF E PJ')\n\n  \n  AND A.ISACTIVE = 1\n\n  AND A.PARENTID = '7016g000000NVrXAAW'\n\n  AND HIST.ID_PROPOSTA IS NULL\n\n  AND A.HC_PARCEIRO__C = B.HC_PARCEIRO__C\n  AND ISNULL(B.HC_NAO_DESEJA_RECEBER_TODOS_MEIOS__C, 0) = 0\n  AND PROP.CREATEDDATE BETWEEN A.HC_DATA_INICIAL_DE_COMPRA__C AND A.HC_DATA_FINAL_DE_COMPRA__C\n  AND (\n\n    (A.HC_VALOR_MINIMO_DE_PARCELA__C IS NULL OR PROP.HC_VALOR__C > A.HC_VALOR_MINIMO_DE_PARCELA__C)\n    AND (A.HC_VALOR_MAXIMO_DA_PARCELA__C IS NULL OR PROP.HC_VALOR__C < A.HC_VALOR_MAXIMO_DA_PARCELA__C)\n  )\n\n  AND (\n\n    (( B.HC_EMAIL_BRASILCAP__C IS NOT NULL OR B.HC_EMAIL_COMERCIAL__C IS NOT NULL OR B.HC_EMAIL_PESSOAL__C IS NOT NULL ) AND ISNULL(B.HC_NAO_DESEJA_RECEBER_EMAIL__C, 0) = 0 )\n\n    OR (\n        ( B.HC_STATUS_CELULAR_1__C = 'VÁLIDO' OR B.HC_STATUS_CELULAR_2__C = 'VÁLIDO' OR B.HC_STATUS_CELULAR_3__C = 'VÁLIDO' \n        OR B.HC_STATUS_CELULAR_3_3__C = 'VÁLIDO' OR B.HC_STATUS_CELULAR_4__C = 'VÁLIDO' ) \n      AND ISNULL(B.HC_NAO_DESEJA_RECEBER_SMS__C, 0) = 0 )\n  )",
  "targetName": "QueryStudioResults at 2023-05-19T1312240000",
  "targetKey": "QueryStudioResults at 2023-05-19T1312240000",
  "targetId": "c8a0a1c6-46f6-ed11-a5c3-d4f5ef66b08b",
  "targetDescription": "Auto generated by Query Studio. Auto deletes after 24 hours.",
  "createdDate": "2022-09-01T10:18:19.84",
  "modifiedDate": "2023-05-19T07:12:25.33",
  "targetUpdateTypeId": 0,
  "targetUpdateTypeName": "Overwrite",
  "categoryId": 1930,
  "isFrozen": false
}