{
  "queryDefinitionId": "d8caa0a8-755f-4a25-b617-9ecbf6ee51cf",
  "name": "Qr00_Base_Prospect_ComOTC_Tratada_NeoBpo",
  "key": "c9371c60-5af3-46c8-ae16-16ef49c45d6d",
  "description": "",
  "queryText": "SELECT DISTINCT\n    CL.HC_CPF_CNPJ__C AS CPF,\n\tC.NAME AS NOME,\n\tHC_IDADE__C AS IDADE,\n\tHC_DATA_DE_NASCIMENTO__C AS Data_Nascimento,\n\tHC_GENERO_DO_CLIENTE__C AS SEXO,\n\tCL.HC_PARCEIRO__C AS PARCEIRO,\n\tCASE \n\t\tWHEN UPPER(CL.HC_ENDERECO_PRINCIPAL__C) = 'RESIDENCIAL' THEN HC_CEP_RES__C\n\t\tWHEN UPPER(CL.HC_ENDERECO_PRINCIPAL__C) = 'COMERCIAL' THEN HC_CEP_COM__C\n\t\tWHEN UPPER(CL.HC_ENDERECO_PRINCIPAL__C) = 'CORRESPONDÊNCIA' THEN HC_CEP_COR__C\n\tEND AS CEP,\n\tCASE \n\t\tWHEN UPPER(CL.HC_ENDERECO_PRINCIPAL__C) = 'RESIDENCIAL' THEN HC_UF_RES__C\n\t\tWHEN UPPER(CL.HC_ENDERECO_PRINCIPAL__C) = 'COMERCIAL' THEN HC_UF_COM__C\n\t\tWHEN UPPER(CL.HC_ENDERECO_PRINCIPAL__C) = 'CORRESPONDÊNCIA' THEN HC_UF_COR__C\n\tEND AS UF,\n\tHC_TIPO_DE_PESSOA__C AS TIPO_PESSOA,\n\tLEFT(REPLACE(REPLACE(REPLACE(REPLACE(HC_TELEFONE_RESIDENCIAL__C, '(', ''), ')', ''), ' ', ''), '-', ''), 2) AS DDD_TEL_01,\n\tSUBSTRING(REPLACE(REPLACE(REPLACE(REPLACE(HC_TELEFONE_RESIDENCIAL__C, '(', ''), ')', ''), ' ', ''), '-', ''), 3, 9) AS TEL_01,\n\t'FIXO' AS TIPO_TEL_01,\n\tLEFT(REPLACE(REPLACE(REPLACE(REPLACE(HC_TELEFONE_COMERCIAL__C, '(', ''), ')', ''), ' ', ''), '-', ''), 2) AS DDD_TEL_02,\n\tSUBSTRING(REPLACE(REPLACE(REPLACE(REPLACE(HC_TELEFONE_COMERCIAL__C, '(', ''), ')', ''), ' ', ''), '-', ''), 3, 9) AS TEL_02,\n\t'FIXO' AS TIPO_TEL_02,\n\tLEFT(REPLACE(REPLACE(REPLACE(REPLACE(HC_TELEFONE_OUTRO__C, '(', ''), ')', ''), ' ', ''), '-', ''), 2) AS DDD_TEL_03,\n\tSUBSTRING(REPLACE(REPLACE(REPLACE(REPLACE(HC_TELEFONE_OUTRO__C, '(', ''), ')', ''), ' ', ''), '-', ''), 3, 9) AS TEL_03,\n\t'FIXO' AS TIPO_TEL_03,\n    LEFT(REPLACE(REPLACE(REPLACE(REPLACE(HC_CELULAR_1__C, '(', ''), ')', ''), ' ', ''), '-', ''), 2) AS DDD_TEL_04,\n\tSUBSTRING(REPLACE(REPLACE(REPLACE(REPLACE(HC_CELULAR_1__C, '(', ''), ')', ''), ' ', ''), '-', ''), 3, 9) AS TEL_04,\n\t'MÓVEL' AS TIPO_TEL_04,\n\tLEFT(REPLACE(REPLACE(REPLACE(REPLACE(HC_CELULAR_2__C, '(', ''), ')', ''), ' ', ''), '-', ''), 2) AS DDD_TEL_05,\n\tSUBSTRING(REPLACE(REPLACE(REPLACE(REPLACE(HC_CELULAR_2__C, '(', ''), ')', ''), ' ', ''), '-', ''), 3, 9) AS TEL_05,\n\t'MÓVEL' AS TIPO_TEL_05,\n\tLEFT(REPLACE(REPLACE(REPLACE(REPLACE(HC_CELULAR_3__C, '(', ''), ')', ''), ' ', ''), '-', ''), 2) AS DDD_TEL_06,\n\tSUBSTRING(REPLACE(REPLACE(REPLACE(REPLACE(HC_CELULAR_3__C, '(', ''), ')', ''), ' ', ''), '-', ''), 3, 9) AS TEL_06,\n\t'MÓVEL' AS TIPO_TEL_06,\n\tHC_TELEFONE_PRINCIPAL__C AS TEL_PRINCIPAL,\n\tHC_CLASSIFICACAO__C AS PUBLICO_ALVO,\n\tCA.[TYPE] AS TIPO_CAMPANHA,\n\tCA.STARTDATE AS DT_INICIO_MAILING,\n\tCA.ENDDATE AS DT_FIM_MAILING,\n\tCA.HC_VALIDA_ALTA_RENDA__C AS CAMPANHA_VALIDA_ENCARTEIRAMENTO,\n    CA.HC_VALIDA_NAO_IMPORTUNE__C AS CAMPANHA_NAO_IMPORTUNE,\n    CA.HC_VALIDA_RNA__C AS CAMPANHA_VALIDA_RNA,\n\tCA.HC_PRODUTO__C AS ID_PRODUTO,\n    CA.HC_PRECO_DO_PRODUTO__C AS ID_PRODUTO_VALOR,\n\tCL.HC_CPF_CNPJ__C AS ID,\n\tCA.ID AS ID_CAMPANHA, \n\tCL.ID AS ID_CLIENTE_PARCEIRO,\n\tC.ID AS ID_CONTATO,\n\tCL.HC_Cliente__c AS ID_CLIENTE,\n\tCL.HC_CPF_CNPJ_CODIGO_DO_PARCEIRO__C AS CPF_CNPJ_CODIGO_DO_PARCEIRO,\n    CA.HC_PRODUTO__C AS NOME_PRODUTO,\n    CA.HC_PRECO_DO_PRODUTO__C AS NOME_PRODUTO_VALOR,\n    CA.HC_VALIDA_ALTA_RENDA__C AS VALIDA_ENCARTEIRAMENTO,\n    CA.HC_VALIDA_NAO_IMPORTUNE__C AS VALIDA_NAO_IMPORTUNE,\n    CA.HC_VALIDA_RNA__C AS VALIDA_RNA,\n    CASE WHEN DATEDIFF(YY, HC_DATA_DE_NASCIMENTO__C, GETDATE()) BETWEEN 18 AND 70 THEN 1 ELSE 0 END AS IDADE_VALIDA,\n    CASE WHEN ( A.AGENCIA != '' AND A.CONTA != '' AND (UPPER(A.TIPO_CONTA) = 'CC' OR UPPER(A.TIPO_CONTA) = 'CONTA CORRENTE') ) THEN 1 ELSE 0 END AS CONTA_CORRENTE,\n    CASE WHEN Q.CPF_CNPJ IS NOT NULL THEN 1 ELSE 0 END AS QUARENTENA,\n    CASE WHEN CL.HC_CPF_CNPJ__C IS NOT NULL AND CL.HC_CLASSIFICACAO__C != 'Cliente Potencial' THEN 1 ELSE 0 END AS CLIENTE,\n    CASE WHEN CL.HC_CPF_CNPJ__C IS NOT NULL AND CL.HC_CONSELHEIRO__C = 1 THEN 1 ELSE 0 END AS CONSELHEIRO,\n\tCASE WHEN ISNULL(A.CEP, '') = '' OR A.CEP = ' ' THEN 0 ELSE 1 END AS CEP_VALIDO\nFROM TB_BASE_PROSPECT_COMOTC_NEOBPO A\nINNER JOIN CAMPAIGN_SALESFORCE CA ON A.FORNECEDOR = CA.HC_FORNECEDOR__C\nINNER JOIN HC_RELACAO_CLIENTE_PARCEIRO__C_SALESFORCE CL ON LTRIM(RTRIM(A.CPF)) = CL.HC_CPF_CNPJ__C\nINNER JOIN Contact_Salesforce C ON C.HC_CPF_CNPJ__c =   CL.HC_CPF_CNPJ__c\nLEFT JOIN TB_BASE_QUARENTENA Q ON LTRIM(RTRIM(A.CPF)) = Q.CPF_CNPJ\nWHERE\n    CA.HC_FORNECEDOR__C = 'NeoBpo'\n/*AND CONVERT(VARCHAR, CA.HC_Data_de_Execucao__c, 112) = CONVERT(VARCHAR, GETDATE(), 112)*/\nAND CA.[TYPE] = 'Prospect'\n/*AND CA.HC_VALIDA_RNA__C = 1*/",
  "targetName": "Tb_Base_Prospect_ComOTC_Tratada_NeoBpo",
  "targetKey": "4619EFE2-816D-469C-A6E0-A1CD2C23E462",
  "targetId": "5a790617-5870-eb11-a2fc-48df37342c98",
  "targetDescription": "",
  "createdDate": "2021-02-16T07:34:05.74",
  "modifiedDate": "2021-09-29T16:52:31.433",
  "targetUpdateTypeId": 0,
  "targetUpdateTypeName": "Overwrite",
  "categoryId": 29369,
  "isFrozen": false
}