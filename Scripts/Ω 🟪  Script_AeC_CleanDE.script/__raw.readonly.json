{
  "ssjsActivityId": "8fe25d87-65ca-4c13-913d-38caa6921488",
  "name": "Script_AeC_CleanDE",
  "key": "c8514698-e3fb-4ae3-ac40-c4c3cc5899c1",
  "description": "",
  "script": "<script runat=server>\n  Platform.Load(\"Core\", \"1.1.5\");\n  var api = new Script.Util.WSProxy();\n  var dataExtensionsName = [\n    'Tb_Base_Prospect_ComOTC_Online_Filtrada_AeC',\n    'Tb_Base_Prospect_OTC291_Online_Tratada_AeC',\n    'Flag_Integracao_Prospect_AeC',\n    'Flag_Extracao_Prospect_AeC',\n    ''\n  ];\n\n  try{\n    var dataExtensionsCustomerKeysToClear = retrieveDEsCustomerKeyByName(dataExtensionsName);\n    var clearObject = [];\n    for (var i = 0; i < dataExtensionsCustomerKeysToClear.length; i++) {\n      clearObject.push({\n        CustomerKey: dataExtensionsCustomerKeysToClear[i].CustomerKey\n      });\n    }\n    var res = api.performBatch(\"DataExtension\", clearObject, \"ClearData\");\n  \n  }catch(error){\n    Platform.Function.RaiseError('Something went wrong');\n  }\n  \n  function retrieveDEsCustomerKeyByName(DEname){\n    var filter = {\n      Property: \"Name\",\n      Value: DEname\n    };\n    \n    if( isArray(DEname) && DEname.length > 1 ){\n      filter.SimpleOperator = \"IN\";\n    }\n    else if(isArray(DEname) && DEname.length == 1){\n      filter.SimpleOperator = \"equals\";\n      filter.Value = DEname[0];\n    }else{\n      filter.SimpleOperator = \"equals\";\n      filter.Value = DEname;\n    }\n    \n    var req = api.retrieve(\"DataExtension\", [\"Name\", \"CustomerKey\"], filter);\n    return req.Results;\n  }\n  \n  function isArray(a) {\n    return (!!a) && Object.prototype.toString.call(a) == '[object Array]'\n  };\n\n</script>",
  "categoryId": 1937,
  "createdDate": "2023-07-05T07:54:15.777",
  "modifiedDate": "2023-07-14T17:02:48.027"
}