{
  "queryDefinitionId": "ae3f2801-b4ff-4054-950c-2df92add8c09",
  "name": "Qr06_Extracao_Base_Prospect_Online_Campanhas_ComOTC_TMKT",
  "key": "276828cd-d71b-40bd-be03-4c2400af3d9c",
  "description": "",
  "queryText": "SELECT COD_PARCEIRO,\n    CPF,\n    CNPJ,\n    Id_Campanha,\n    ID,\n    Id_Contato,\n    TEL_01,\n    TEL_02,\n    TEL_03,\n    TEL_04, \n    null as 'Telefone Residencial'\nFROM (SELECT DISTINCT\n    'TCBB' AS COD_PARCEIRO,\n    A.CPF,\n    '' AS CNPJ,\n    B.Id_Campanha,\n    E.Id as ID,\n    C.ID as Id_Contato,\n    CASE WHEN B.Celular1 LIKE '%(0)%' THEN '' else B.Celular1 END as TEL_01,\n    CASE WHEN B.Celular2 LIKE '%(0)%' THEN '' else B.Celular2 END as TEL_02,\n    CASE WHEN b.TEL_RESIDENCIAL LIKE '%(0)%' THEN '' else b.TEL_RESIDENCIAL END as TEL_03,\n    CASE WHEN b.TEL_COMERCIAL LIKE '%(0)%' THEN '' else b.TEL_COMERCIAL END as TEL_04,\n    row_number() over (partition by A.CPF order by C.ID desc) AS ROW_ID\n\nFROM\n  Tb_Base_Prospect_OTC291_Filtrada_TMKT A \n  INNER JOIN Tb_Base_Prospect_OTC291_Tratada_TMKT B ON A.CPF = B.CPF\n  INNER JOIN Contact_Salesforce C on RIGHT(REPLICATE ('0' , 15)+CONVERT(VARCHAR, C.HC_CPF_CNPJ__c), 11) = B.CPF\n  INNER JOIN ACCOUNT_SALESFORCE D on C.AccountId = D.ID\n  INNER JOIN HC_Relacao_Cliente_Parceiro__c_Salesforce E ON A.CPF = E.CPF_CNPJ_Cliente__c) BASE\nWHERE ROW_ID = 1\n  ",
  "targetName": "Tb_Base_Prospect_Offline_Campanhas_ComOTC_TMKT",
  "targetKey": "F8AE1D9B-7176-4E70-AC9F-C5BB05A73280",
  "targetId": "fe375eda-2284-eb11-a2fd-48df370eabe5",
  "targetDescription": "",
  "createdDate": "2021-03-13T14:04:34.177",
  "modifiedDate": "2023-07-11T16:00:08.57",
  "targetUpdateTypeId": 0,
  "targetUpdateTypeName": "Overwrite",
  "categoryId": 40742,
  "isFrozen": false
}