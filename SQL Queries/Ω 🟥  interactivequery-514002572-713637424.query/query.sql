SELECT TOP 30
    rtrim(left(coalesce(CAST(B.HC_Nome_Cliente__c as char(255)),'<null>'), 255)) as nome, rtrim(left(coalesce(CAST(B.HC_CPF_CNPJ__c as char(255)),'<null>'), 255)) as cpf, rtrim(left(coalesce(CAST(B.HC_Agencia_1__c as char(255)),'<null>'), 255)) as agencia, rtrim(left(coalesce(CAST(B.HC_Numero_da_Conta_1__c as char(255)),'<null>'), 255)) as conta, rtrim(left(coalesce(CAST(B.HC_Tipo_da_Conta_1__c as char(255)),'<null>'), 255)) as tipoconta, rtrim(left(coalesce(CAST(B.HC_Data_de_Nascimento__c as char(255)),'<null>'), 255)) as datanascimento, rtrim(left(coalesce(CAST(B.HC_CEP_Res__c as char(255)),'<null>'), 255)) as cep, rtrim(left(coalesce(CAST(REPLACE(REPLACE(SUBSTRING(B.HC_Celular_1__c, 1, 4), '(', ''), ')', '') as char(255)),'<null>'), 255)) as dddcelular1, rtrim(left(coalesce(CAST(REPLACE(SUBSTRING(B.HC_Celular_1__c, 6, LEN(B.HC_Celular_1__c) - 5), '-', '') as char(255)),'<null>'), 255)) as celular1, rtrim(left(coalesce(CAST(REPLACE(REPLACE(SUBSTRING(B.HC_Celular_2__c, 1, 4), '(', ''), ')', '') as char(255)),'<null>'), 255)) as dddcelular2, rtrim(left(coalesce(CAST(REPLACE(SUBSTRING(B.HC_Celular_2__c, 6, LEN(B.HC_Celular_2__c) - 5), '-', '') as char(255)),'<null>'), 255)) as celular2, rtrim(left(coalesce(CAST(REPLACE(REPLACE(SUBSTRING(B.HC_Celular_3_3__c, 1, 4), '(', ''), ')', '') as char(255)),'<null>'), 255)) as dddcelular3, rtrim(left(coalesce(CAST(REPLACE(SUBSTRING(B.HC_Celular_3_3__c, 6, LEN(B.HC_Celular_3_3__c) - 5), '-', '') as char(255)),'<null>'), 255)) as celular3, rtrim(left(coalesce(CAST(REPLACE(REPLACE(SUBSTRING(B.HC_Telefone_Residencial__c, 1, 4), '(', ''), ')', '') as char(255)),'<null>'), 255)) as dddfixo1, rtrim(left(coalesce(CAST(REPLACE(SUBSTRING(B.HC_Telefone_Residencial__c, 6, LEN(B.HC_Telefone_Residencial__c) - 5), '-', '') as char(255)),'<null>'), 255)) as fixo1, rtrim(left(coalesce(CAST(REPLACE(REPLACE(SUBSTRING(B.HC_Telefone_Comercial__c, 1, 4), '(', ''), ')', '') as char(255)),'<null>'), 255)) as dddfixo2, rtrim(left(coalesce(CAST(REPLACE(SUBSTRING(B.HC_Telefone_Comercial__c, 6, LEN(B.HC_Telefone_Comercial__c) - 5), '-', '') as char(255)),'<null>'), 255)) as fixo2, rtrim(left(coalesce(CAST(REPLACE(REPLACE(SUBSTRING(B.HC_Telefone_Outro__c, 1, 4), '(', ''), ')', '') as char(255)),'<null>'), 255)) as dddfixo3, rtrim(left(coalesce(CAST(REPLACE(SUBSTRING(B.HC_Telefone_Outro__c, 6, LEN(B.HC_Telefone_Outro__c) - 5), '-', '') as char(255)),'<null>'), 255)) as fixo3, rtrim(left(coalesce(CAST(B.HC_Digito_da_Conta_1__c as char(255)),'<null>'), 255)) as digitoconta, rtrim(left(coalesce(CAST(B.HC_Genero_do_Cliente__c as char(255)),'<null>'), 255)) as sexo from HC_Relacao_Cliente_Parceiro__c_Salesforce B
WHERE
    B.HC_CPF_CNPJ__c IN (SELECT CPF from RenovacaoAutomaticaDE)
AND (B.HC_Id_Parceiro_Cap__c = 'TCBB' OR B.HC_Id_Parceiro_Darwin__c = '1')