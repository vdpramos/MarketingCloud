{
  "queryDefinitionId": "2a510841-6c3f-4455-86df-44580c63f924",
  "name": "Qr03_Extracao_Base_Prospect_Offline_Telefone_ComOTC_Teo",
  "key": "9d07e7fd-9f1e-4095-8c90-e7b396423d89",
  "description": "",
  "queryText": "SELECT \n  COD_PARCEIRO,\n  CPF,\n  CNPJ,\n  TIPO,\n  DDD,\n  TELEFONE\nFROM (\n\n  SELECT DISTINCT\n    'TCBB' AS COD_PARCEIRO,\n    A.CPF,\n    '' AS CNPJ,\n    CASE WHEN LEN(B.TEL_01) >= 9 THEN 'MÓVEL' ELSE 'FIXO' END AS TIPO,\n    B.DDD_01 AS DDD,\n    B.TEL_01 AS TELEFONE\n  FROM\n    TB_BASE_PROSPECT_OTC291_FILTRADA_TEO A \n    INNER JOIN\n      TB_BASE_PROSPECT_COMOTC_TRATADA_TEO B \n      ON A.CPF = RIGHT(REPLICATE ('0' , 15)+CONVERT(VARCHAR, B.CPF), 11)\n  WHERE\n       LEN(NULLIF(TEL_01, '')) < 10\n  AND NOT( LEN(TEL_01) = 8 AND TEL_01 LIKE '9%' )\n  \n  UNION ALL\n\n  SELECT DISTINCT\n    'TCBB' AS COD_PARCEIRO,\n    A.CPF,\n    '' AS CNPJ,\n    CASE WHEN LEN(B.TEL_02) >= 9 THEN 'MÓVEL' ELSE 'FIXO' END AS TIPO,\n    B.DDD_02 AS DDD,\n    B.TEL_02 AS TELEFONE\n  FROM\n    TB_BASE_PROSPECT_OTC291_FILTRADA_TEO A \n    INNER JOIN\n      TB_BASE_PROSPECT_COMOTC_TRATADA_TEO B \n      ON A.CPF = RIGHT(REPLICATE ('0' , 15)+CONVERT(VARCHAR, B.CPF), 11)\n  WHERE\n       LEN(NULLIF(TEL_02, '')) < 10\n  AND NOT( LEN(TEL_02) = 8 AND TEL_02 LIKE '9%' )\n  \n  UNION ALL\n\n  SELECT DISTINCT\n    'TCBB' AS COD_PARCEIRO,\n    A.CPF,\n    '' AS CNPJ,\n    CASE WHEN LEN(B.TEL_03) >= 9 THEN 'MÓVEL' ELSE 'FIXO' END AS TIPO,\n    B.DDD_03 AS DDD,\n    B.TEL_03 AS TELEFONE\n  FROM\n    TB_BASE_PROSPECT_OTC291_FILTRADA_TEO A \n    INNER JOIN\n      TB_BASE_PROSPECT_COMOTC_TRATADA_TEO B \n      ON A.CPF = RIGHT(REPLICATE ('0' , 15)+CONVERT(VARCHAR, B.CPF), 11)\n  WHERE\n       LEN(NULLIF(TEL_03, '')) < 10\n  AND NOT( LEN(TEL_03) = 8 AND TEL_03 LIKE '9%' )\n  \n  UNION ALL\n\n  SELECT DISTINCT\n    'TCBB' AS COD_PARCEIRO,\n    A.CPF,\n    '' AS CNPJ,\n    CASE WHEN LEN(B.TEL_04) >= 9 THEN 'MÓVEL' ELSE 'FIXO' END AS TIPO,\n    B.DDD_04 AS DDD,\n    B.TEL_04 AS TELEFONE\n  FROM\n    TB_BASE_PROSPECT_OTC291_FILTRADA_TEO A \n    INNER JOIN\n      TB_BASE_PROSPECT_COMOTC_TRATADA_TEO B \n      ON A.CPF = RIGHT(REPLICATE ('0' , 15)+CONVERT(VARCHAR, B.CPF), 11)\n  WHERE\n       LEN(NULLIF(TEL_04, '')) < 10\n  AND NOT( LEN(TEL_04) = 8 AND TEL_04 LIKE '9%' )\n  \n  UNION ALL\n\n  SELECT DISTINCT\n    'TCBB' AS COD_PARCEIRO,\n    A.CPF,\n    '' AS CNPJ,\n    CASE WHEN LEN(B.TEL_05) >= 9 THEN 'MÓVEL' ELSE 'FIXO' END AS TIPO,\n    B.DDD_05 AS DDD,\n    B.TEL_05 AS TELEFONE\n  FROM\n    TB_BASE_PROSPECT_OTC291_FILTRADA_TEO A \n    INNER JOIN\n      TB_BASE_PROSPECT_COMOTC_TRATADA_TEO B \n      ON A.CPF = RIGHT(REPLICATE ('0' , 15)+CONVERT(VARCHAR, B.CPF), 11)\n  WHERE\n      LEN(NULLIF(TEL_05, '')) < 10\n  AND NOT( LEN(TEL_05) = 8 AND TEL_05 LIKE '9%' )\n) A",
  "targetName": "Tb_Base_Prospect_Offline_Telefones_ComOTC_Teo",
  "targetKey": "785B07FC-D6AC-4333-BC84-57DFA0B4E334",
  "targetId": "331130bd-8170-eb11-a2fc-48df37342c98",
  "targetDescription": "",
  "createdDate": "2021-02-16T12:54:26.907",
  "modifiedDate": "2022-03-24T15:18:50.523",
  "targetUpdateTypeId": 0,
  "targetUpdateTypeName": "Overwrite",
  "categoryId": 29379,
  "isFrozen": false
}