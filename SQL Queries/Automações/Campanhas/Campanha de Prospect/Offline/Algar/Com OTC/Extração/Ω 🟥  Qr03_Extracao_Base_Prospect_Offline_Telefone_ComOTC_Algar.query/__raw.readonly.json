{
  "queryDefinitionId": "32151ed8-6117-43ae-b276-b048b9be6bf7",
  "name": "Qr03_Extracao_Base_Prospect_Offline_Telefone_ComOTC_Algar",
  "key": "fc278df9-160d-43fb-bcbd-d15257de0fbe",
  "description": "",
  "queryText": "SELECT \n  COD_PARCEIRO,\n  CPF,\n  CNPJ,\n  TIPO,\n  DDD,\n  TELEFONE\nFROM (\n  \n  SELECT DISTINCT\n    'TCBB' AS COD_PARCEIRO,\n    A.CPF,\n    '' AS CNPJ,\n    CASE WHEN LEN(B.TEL_01) >= 9 THEN 'MÓVEL' ELSE 'FIXO' END AS TIPO,\n    B.DDD_01 AS DDD,\n    B.TEL_01 AS TELEFONE\n  FROM\n    TB_BASE_PROSPECT_OTC291_FILTRADA_ALGAR A \n    INNER JOIN\n      TB_BASE_PROSPECT_COMOTC_TRATADA_ALGAR B \n      ON A.CPF = RIGHT(REPLICATE ('0' , 15)+CONVERT(VARCHAR, B.CPF), 11)\n  WHERE\n       LEN(NULLIF(TEL_01, '')) < 10\n  AND NOT( LEN(TEL_01) = 8 AND TEL_01 LIKE '9%' )\n  \n  UNION ALL\n\n  SELECT DISTINCT\n    'TCBB' AS COD_PARCEIRO,\n    A.CPF,\n    '' AS CNPJ,\n    CASE WHEN LEN(B.TEL_02) >= 9 THEN 'MÓVEL' ELSE 'FIXO' END AS TIPO,\n    B.DDD_02 AS DDD,\n    B.TEL_02 AS TELEFONE\n  FROM\n    TB_BASE_PROSPECT_OTC291_FILTRADA_ALGAR A \n    INNER JOIN\n      TB_BASE_PROSPECT_COMOTC_TRATADA_ALGAR B \n      ON A.CPF = RIGHT(REPLICATE ('0' , 15)+CONVERT(VARCHAR, B.CPF), 11)\n  WHERE\n       LEN(NULLIF(TEL_02, '')) < 10\n  AND NOT( LEN(TEL_02) = 8 AND TEL_02 LIKE '9%' )\n  \n  UNION ALL\n\n  SELECT DISTINCT\n    'TCBB' AS COD_PARCEIRO,\n    A.CPF,\n    '' AS CNPJ,\n    CASE WHEN LEN(B.TEL_03) >= 9 THEN 'MÓVEL' ELSE 'FIXO' END AS TIPO,\n    B.DDD_03 AS DDD,\n    B.TEL_03 AS TELEFONE\n  FROM\n    TB_BASE_PROSPECT_OTC291_FILTRADA_ALGAR A \n    INNER JOIN\n      TB_BASE_PROSPECT_COMOTC_TRATADA_ALGAR B \n      ON A.CPF = RIGHT(REPLICATE ('0' , 15)+CONVERT(VARCHAR, B.CPF), 11)\n  WHERE\n       LEN(NULLIF(TEL_03, '')) < 10\n  AND NOT( LEN(TEL_03) = 8 AND TEL_03 LIKE '9%' )\n  \n  UNION ALL\n\n  SELECT DISTINCT\n    'TCBB' AS COD_PARCEIRO,\n    A.CPF,\n    '' AS CNPJ,\n    CASE WHEN LEN(B.TEL_04) >= 9 THEN 'MÓVEL' ELSE 'FIXO' END AS TIPO,\n    B.DDD_04 AS DDD,\n    B.TEL_04 AS TELEFONE\n  FROM\n    TB_BASE_PROSPECT_OTC291_FILTRADA_ALGAR A \n    INNER JOIN\n      TB_BASE_PROSPECT_COMOTC_TRATADA_ALGAR B \n      ON A.CPF = RIGHT(REPLICATE ('0' , 15)+CONVERT(VARCHAR, B.CPF), 11)\n  WHERE\n       LEN(NULLIF(TEL_04, '')) < 10\n  AND NOT( LEN(TEL_04) = 8 AND TEL_04 LIKE '9%' )\n  \n  UNION ALL\n\n  SELECT DISTINCT\n    'TCBB' AS COD_PARCEIRO,\n    A.CPF,\n    '' AS CNPJ,\n    CASE WHEN LEN(B.TEL_05) >= 9 THEN 'MÓVEL' ELSE 'FIXO' END AS TIPO,\n    B.DDD_05 AS DDD,\n    B.TEL_05 AS TELEFONE\n  FROM\n    TB_BASE_PROSPECT_OTC291_FILTRADA_ALGAR A \n    INNER JOIN\n      TB_BASE_PROSPECT_COMOTC_TRATADA_ALGAR B \n      ON A.CPF = RIGHT(REPLICATE ('0' , 15)+CONVERT(VARCHAR, B.CPF), 11)\n  WHERE\n      LEN(NULLIF(TEL_05, '')) < 10\n  AND NOT( LEN(TEL_05) = 8 AND TEL_05 LIKE '9%' )\n) A",
  "targetName": "Tb_Base_Prospect_Offline_Telefones_ComOTC_Algar",
  "targetKey": "7A1A36B2-0AF7-448C-BC5A-0D07FEC2542B",
  "targetId": "242a0ff9-6445-eb11-a2f2-48df370ed7f4",
  "targetDescription": "",
  "createdDate": "2021-01-27T17:01:36.503",
  "modifiedDate": "2022-03-16T04:40:10.23",
  "targetUpdateTypeId": 0,
  "targetUpdateTypeName": "Overwrite",
  "categoryId": 29375,
  "isFrozen": false
}