{
  "ssjsActivityId": "1dfeee08-e1bf-41ca-978f-5e516701eea3",
  "name": "Prospect_Teo_Upsert_Contact",
  "key": "a0bc0cc4-c7e0-4a12-be5e-39998df74a77",
  "description": "Faz o upsert do Contato com os dados da DE OTC291 Filtrado",
  "script": "<script runat=\"server\">\r\nPlatform(\"Core\", \"2.0\");\r\nvar api = new Script.Util.WSProxy();\r\nvar urlToUpsert = 'https://brasilcap.my.salesforce.com/services/data/v52.0/composite/sobjects/Contact/HC_CPF_CNPJ_Tipo_de_Relacionamento__c';\r\nvar nameDE = 'Tb_Base_Prospect_OTC291_Filtrada_Teo';\r\nvar idCampanha = '7016g000002O0CIAA0';\r\nvar attributeType = 'Contact'; // Objeto para inserir\r\nvar BATCH_SIZE = 200; // 1 a 2500\r\n// Colocar como está o nome do campo no Data Extension (de) como atributo (esquerdo) e com qual nome deve ser enviado para o Service (para)\r\n// no lado direito como valor\r\nvar deparaCampos = {\r\n  \"CPF\": \"HC_CPF_CNPJ__c\",\r\n  \"Primeiro_Nome\": \"FirstName\",\r\n  \"Sobrenome\": \"LastName\",\r\n  \"Id_Conta\": \"AccountId\",\r\n  \"CPF_Tipo_Relacionamento\": \"HC_CPF_CNPJ_Tipo_de_Relacionamento__c\"\r\n}\r\n\r\n// Usar caso haja valores para inserir carimbados (que não são variáveis de acordo com a base)\r\nvar valoresFixos = {\r\n  \"HC_Tipo_de_Relacionamento__c\": \"Cliente\"\r\n}\r\n\r\n// DE OTC291 filtrado\r\nvar campoIdNoDEParaAtualizar = 'Id_Contato';\r\nvar campoPKNoDEParaAtualizar = 'CPF';\r\n\r\n// Formatar campos de data para formato YYYY-MM-DD\r\n// Usar lado direito no caso do objeto deparaCampos\r\n// var dateFieldsToFormat = [\r\n// ];\r\n\r\n// Aplicar um filtro para trazer do DE apenas linhas desejadas\r\nvar applyFilterRetrieve = true; // flag para usar o filtro \"filterRetrieveRows\"\r\n// Campo para atualizar o DE informando que um contato já teve a tentativa de disparo\r\n// Para caso o Script precise ser executado novamente\r\nvar flagEnvioParaService = 'Envio_Service_Contact';\r\nvar filterRetrieveRows = {\r\n  LeftOperand:{\r\n    Property: flagEnvioParaService,\r\n    SimpleOperator: 'equals',\r\n    Value: false\r\n  },\r\n  LogicalOperator:\"AND\",\r\n  RightOperand:{\r\n    Property: 'Row',\r\n    SimpleOperator: 'lessThan', \r\n    Value: 75000\r\n  }\r\n}\r\n\r\neval(Platform.Function.TreatAsContent( Platform.Function.ContentBlockByID('56360') ));\r\n\r\n</script>",
  "categoryId": 38499,
  "createdDate": "2022-03-25T02:42:03.1",
  "modifiedDate": "2022-04-16T13:32:21.023"
}